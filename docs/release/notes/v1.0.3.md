# ✨ Ghost-Dir 1.0.3

> 发布日期：2026-02-27

功能增强版本，新增 USN Journal 全盘深度链接扫描和 UI 体验优化。

## ✨ 新功能

- **USN Journal 全盘扫描**：通过 NTFS MFT 枚举发现磁盘上所有 Junction/Symlink 目录链接，无深度限制，单盘扫描仅需 2-5 秒
- **双模式探测引擎**：管理员权限下使用 USN Journal 极速扫描，权限不足时自动降级到目录遍历（2 级深度）
- **系统链接智能过滤**：通过 `HIDDEN+SYSTEM` 属性和路径特征双重过滤，排除 Windows 系统兼容链接（如 `All Users`、`Application Data`、`Content.IE5` 等）
- **非模板链接分类选择**：扫描发现的非模板链接支持在扫描结果中选择分类

## 🎨 UI 优化

- **路径文本省略**：长路径使用 `ElideMiddle` 中间截断 + tooltip 显示完整路径，不再撑破布局
- **分类下拉面板**：禁用水平滚动条，tooltip 显示完整分类名
- **仅扫描本地固定磁盘**：排除网络驱动器、U 盘和移动硬盘，提升扫描速度

## 🐛 Bug 修复

- **修复 exe 打包后 USN Journal 不可用**：`main.py`（exe 入口）缺少管理员权限请求，导致 USN Journal 无法打开卷句柄，静默降级到 2 级目录遍历
- **修复 USN_RECORD_V2 结构体解析错误**：`struct.unpack_from` 格式字符串多了一个 `I`，导致后续字段偏移错位，所有链接路径解析失败
- **修复 ctypes 64 位兼容性**：`CreateFileW.restype` 未声明为 `c_void_p`，导致 64 位 Python 下句柄比较逻辑错误
- **修复 PyInstaller 延迟 import 丢失**：`usn_journal` 模块通过方法内延迟 import 引入，PyInstaller 无法静态检测到依赖

## 📦 下载

- **Windows 64-bit**：`Ghost-Dir-1.0.3-win64.zip`（发布页附件）

## 🔗 相关链接

- [完整更新日志](../CHANGELOG.md)
- [上一版本说明](v1.0.2.md)
